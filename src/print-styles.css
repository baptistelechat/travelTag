/* Styles spécifiques pour l'impression */
@media print {
  /* Masquer tous les éléments par défaut */
  body * {
    visibility: hidden;
  }

  /* Configuration de base de la page A4 */
  @page {
    size: A4 portrait;
    margin: 0;
  }

  /* Styles généraux pour le mode impression */
  html.print-mode {
    height: 100%;
    overflow: visible;
  }

  html.print-mode body {
    height: 100%;
    overflow: visible;
  }

  /* Styles pour l'affichage d'un seul QR code */
  body.print-single #qrcode-display,
  body.print-single #qrcode-display * {
    visibility: visible !important;
  }

  body.print-single #qrcode-display {
    position: fixed;
    top: 0;
    left: 0;
    width: 210mm; /* Largeur A4 */
    height: 297mm; /* Hauteur A4 */
    margin: 0;
    padding: 0;
    border: none;
    display: flex;
    justify-content: center;
    align-items: center;
    box-sizing: border-box;
    page-break-after: avoid;
    page-break-before: avoid;
    page-break-inside: avoid;
  }

  body.print-single {
    height: 297mm; /* Hauteur exacte A4 */
    width: 210mm; /* Largeur exacte A4 */
    overflow: hidden;
    page-break-after: avoid;
  }

  body.print-single #qrcode-display .border-dashed {
    border: none !important;
    padding: 20px !important;
  }

  body.print-single #qrcode-display .p-6 {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    width: 100% !important;
    height: 100% !important;
    padding: 20mm !important;
  }

  body.print-single #qrcode-display svg {
    width: 150mm !important;
    height: 150mm !important;
    display: block !important;
    margin: 0 auto !important;
  }

  body.print-single #qrcode-display .text-center,
  body.print-single #qrcode-display .font-medium {
    color: black !important;
    margin: 10mm 0 !important;
    text-align: center !important;
    font-size: 24pt !important;
    font-weight: bold !important;
  }

  body.print-single #qrcode-display .text-xs,
  body.print-single #qrcode-display .text-gray-500 {
    color: black !important;
    margin: 10mm 0 !important;
    text-align: center !important;
    font-size: 14pt !important;
  }

  /* Styles pour l'affichage en grille de QR codes */
  /* Par défaut, la grille est cachée */
  #qrcode-grid,
  #print-grid-container,
  .print-grid-container {
    visibility: hidden;
    display: none;
  }

  /* La grille n'est visible qu'en mode d'impression grid */
  body.print-grid #qrcode-grid,
  body.print-grid #print-grid-container,
  body.print-grid .print-grid-container {
    visibility: visible !important;
    display: block !important;
  }

  body.print-grid #qrcode-grid *,
  body.print-grid #print-grid-container *,
  body.print-grid .print-grid-container * {
    visibility: visible !important;
  }

  /* Conteneur principal de la grille */
  body.print-grid #qrcode-grid {
    position: absolute;
    top: 0;
    left: 0;
    width: 210mm; /* Largeur A4 */
    height: 297mm; /* Hauteur A4 */
    padding: 5mm; /* Marge intérieure réduite pour donner plus d'espace à la grille */
    padding-top: 3mm; /* Réduction du padding en haut pour donner plus d'espace à la grille */
    padding-bottom: 3mm; /* Réduction du padding en bas pour donner plus d'espace à la grille */
    box-sizing: border-box;
    background-color: white !important;
    z-index: 9999 !important;
    visibility: visible !important;
    display: block !important;
    overflow: hidden !important;
  }

  /* Conteneur de la grille */
  body.print-grid .grid-container {
    display: grid !important;
    /* Les colonnes et lignes sont définies dynamiquement par le style inline dans QRCodeGrid.tsx */
    gap: 2mm !important; /* Espacement encore plus réduit entre les éléments pour éviter les coupures */
    width: 100% !important;
    height: 100% !important;
    background-color: white !important;
    visibility: visible !important;
    margin: 0 auto !important; /* Centre la grille */
  }

  /* Élément individuel de la grille */
  body.print-grid .qrcode-item {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 2mm !important; /* Réduction du padding pour donner plus d'espace au contenu */
    padding-top: 3mm !important; /* Padding supplémentaire en haut pour éviter que le nom ne soit coupé */
    padding-bottom: 3mm !important; /* Padding supplémentaire en bas pour éviter que l'URL ne soit coupée */
    background-color: white !important;
    visibility: visible !important;
    page-break-inside: avoid !important;
    box-sizing: border-box !important;
    width: 100% !important;
    height: 100% !important;
    overflow: hidden !important;
  }

  /* Contenu du QR code */
  body.print-grid .qrcode-content {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    width: 100% !important;
    height: 100% !important;
    background-color: white !important;
    visibility: visible !important;
  }

  /* Nom au-dessus du QR code - taille adaptative selon la configuration de la grille */
  body.print-grid .qrcode-name {
    font-weight: 500 !important;
    /* Marges adaptatives basées sur la configuration de la grille */
    margin-top: calc(1mm + (2mm - 1mm) * (1 - (var(--grid-cols) * var(--grid-rows)) / 24)) !important;
    margin-bottom: calc(1mm + (3mm - 1mm) * (1 - (var(--grid-cols) * var(--grid-rows)) / 24)) !important;
    text-align: center !important;
    color: black !important;
    /* Taille de police adaptative basée sur le nombre de colonnes et de lignes */
    font-size: calc(10pt + (14pt - 10pt) * (1 - (var(--grid-cols) * var(--grid-rows)) / 24)) !important;
  }

  /* Conteneur du SVG du QR code */
  body.print-grid .qrcode-svg-container {
    width: 100% !important;
    height: auto !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    margin: 0 auto !important;
    background-color: white !important;
    visibility: visible !important;
  }

  /* SVG du QR code */
  body.print-grid .qrcode-svg-container svg {
    width: 100% !important;
    height: auto !important;
    /* Ajuster la taille maximale en fonction du nombre de colonnes et de lignes */
    max-width: calc((200mm / var(--grid-cols)) - 5mm) !important;
    max-height: calc((287mm / var(--grid-rows)) - 10mm) !important;
    display: block !important;
    margin: 0 auto !important;
    background-color: white !important;
    color: black !important;
    visibility: visible !important;
  }

  /* URL sous le QR code - taille adaptative selon la configuration de la grille */
  body.print-grid .qrcode-url {
    /* Taille de police adaptative basée sur le nombre de colonnes et de lignes */
    font-size: calc(7pt + (10pt - 7pt) * (1 - (var(--grid-cols) * var(--grid-rows)) / 24)) !important;
    color: black !important;
    /* Marge adaptative basée sur la configuration de la grille */
    margin-top: calc(1mm + (3mm - 1mm) * (1 - (var(--grid-cols) * var(--grid-rows)) / 24)) !important;
    margin-bottom: 1mm !important; /* Marge en bas pour éviter que le texte ne soit coupé */
    text-align: center !important;
  }

  /* Message quand aucune donnée n'est disponible */
  body.print-grid .print-message {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    color: black !important;
    text-align: center;
    width: 80%;
    padding: 20px;
    border: 1px solid #ccc;
    background-color: white;
  }
}
